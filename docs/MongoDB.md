---
aliases: [몽고DB, mongodb, 몽고디비]
---

# MongoDB

> 스키마 유연하게 빠르게 개발하고 싶을 때

[[NoSQL]] [[문서형 데이터베이스]]다. 2009년에 나왔고, NoSQL 중 가장 인기 있다. 데이터를 [[JSON]] 형태의 문서(Document)로 저장한다. 테이블 대신 컬렉션, 행 대신 문서.

스키마가 유연하다. 같은 컬렉션에 구조가 다른 문서가 들어가도 된다. 서비스 초기에 데이터 구조가 자주 바뀔 때 편하다. 마이그레이션 없이 필드 추가/삭제 가능.

[[RDBMS]] 쓰던 사람이 오면 사고방식을 바꿔야 한다. JOIN이 없다 (정확히는 $lookup이 있지만 성능이 안 좋다). 비정규화해서 한 문서에 필요한 데이터를 다 넣는 게 패턴이다.

스타트업 MVP, 콘텐츠 관리, 실시간 분석, IoT 데이터 저장에 적합하다. 복잡한 트랜잭션, 강한 일관성이 필요하면 [[RDBMS]] 쓰는 게 낫다.

## 성능

읽기/쓰기 모두 빠르다. 인덱스만 잘 타면 밀리초 단위 응답. 문서 구조로 저장하니까 한 번 읽기로 필요한 데이터 다 가져올 수 있다.

[[WiredTiger]]가 기본 스토리지 엔진이다. 압축, 암호화 지원. 문서 수준 잠금이라 동시성 좋다.

수평 확장(Sharding)이 설계에 녹아있다. 샤드 추가하면 자동으로 데이터 분산. 수십 테라, 수억 건도 처리 가능. [[Replica Set]]으로 고가용성도 쉽게 구성.

Aggregation Pipeline으로 복잡한 데이터 가공 가능. GROUP BY, JOIN 비슷한 거 다 된다. 하지만 [[SQL]]보다 문법이 복잡하다.

## 생태계

[[Mongoose]]가 [[Node.js]]에서 사실상 표준. 스키마 정의, 검증, 미들웨어 다 지원. [[Python]]은 [[PyMongo]], [[Motor]](비동기). [[Java]]는 공식 드라이버나 [[Spring Data MongoDB]].

[[MongoDB Atlas]]가 클라우드 매니지드 서비스다. 무료 티어도 있어서 개인 프로젝트에 좋다. 자동 백업, 모니터링, 스케일링 다 알아서 해준다.

[[MongoDB Compass]]가 공식 GUI. 쿼리 작성, 인덱스 관리, 성능 분석 가능. [[Mongosh]]가 새 CLI 셸.

[[Change Streams]]로 실시간 데이터 변경 감지 가능. [[Realm]]으로 모바일 동기화. [[Atlas Search]]로 전문 검색.

## 주의점

**스키마 없다고 설계 안 하면 망함**: 유연하다고 아무렇게나 넣으면 나중에 지옥 된다. 문서 구조 미리 설계하고, [[Mongoose]] 같은 ODM으로 검증하자. 스키마리스가 아니라 스키마-온-리드다.

**$lookup 남용 금지**: JOIN처럼 쓰고 싶어서 $lookup 쓰면 성능 망한다. MongoDB는 비정규화가 기본이다. 자주 같이 읽는 데이터는 임베딩하자.

**인덱스 안 타면 컬렉션 풀스캔**: explain() 꼭 확인. 복합 인덱스 순서가 중요하다. ESR 규칙 (Equality, Sort, Range) 따라서 인덱스 설계하자.

**문서 크기 제한**: 단일 문서 16MB 제한. 파일 저장하려면 [[GridFS]] 쓰거나 [[S3]] 분리하자.

**트랜잭션 주의**: 4.0부터 멀티 문서 트랜잭션 지원하지만 성능 오버헤드 있다. 가능하면 단일 문서 원자성으로 해결하도록 설계하자. Replica Set 또는 Sharded Cluster에서만 트랜잭션 됨.

**메모리**: 인덱스와 워킹셋이 RAM에 올라와야 빠르다. 메모리 부족하면 디스크 읽기 발생해서 급격히 느려진다. 모니터링 필수.

**샤딩 키 선택**: 잘못 선택하면 핫스팟 발생. 카디널리티 높고, 쿼리 패턴에 맞는 키 선택해야 한다. 나중에 바꾸기 매우 어려움.

## 주요 기능

- 문서 지향 데이터 모델 (BSON)
- 동적 스키마 (Schema-less)
- Aggregation Pipeline
- 인덱싱 (복합, 지리공간, 텍스트, 해시 등)
- Replica Set (자동 페일오버)
- Sharding (수평 확장)
- Change Streams (실시간 변경 감지)
- 멀티 문서 트랜잭션

## 기타

MongoDB 이름은 "humongous"(거대한)에서 왔다. 대용량 데이터 처리를 목표로 만들어졌다는 의미다. 2009년 10gen이라는 회사에서 시작했는데, 나중에 회사 이름도 MongoDB Inc.로 바꿨다.

NoSQL 붐의 상징적인 존재였다. 2010년대 초반 "MongoDB는 웹 스케일"이라는 말이 밈이 됐다. 실제로는 초기 버전이 데이터 유실 문제가 있었는데, 과대광고가 심했다는 비판도 있었다. 지금은 많이 안정화됐다.

라이센스 논란이 있었다. 2018년 SSPL(Server Side Public License)로 바꿨는데, 이게 오픈소스로 인정받지 못했다. AWS가 DocumentDB라는 MongoDB 호환 서비스를 만들자, MongoDB가 자사 클라우드 서비스를 보호하려고 라이센스를 바꾼 거였다.

"MongoDB University"라는 무료 온라인 교육 플랫폼을 운영한다. 수료증도 준다. 개발자 교육에 투자를 많이 해서 커뮤니티가 빠르게 성장했다. 이게 MongoDB 생태계 확장에 큰 역할을 했다는 평가.
